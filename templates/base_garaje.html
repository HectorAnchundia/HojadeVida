<!DOCTYPE html>
{% load static %}
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Venta de Garaje{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- CSS personalizado -->
    <link rel="stylesheet" href="{% static 'css/themes.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/sidebar-icons.css' %}">
    <link rel="stylesheet" href="{% static 'css/garaje.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body class="garaje-mode">
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar simplificado para Venta de Garaje -->
            <div class="sidebar">
                <!-- Perfil -->
                <div class="profile-container">
                    {% if datos_personales %}
                        {% if datos_personales.varyingpic %}
                        <img src="{{ datos_personales.varyingpic.url }}" 
                             alt="Foto de perfil" 
                             class="profile-image"
                             onerror="this.onerror=null; this.src='{% static 'img/default-profile.png' %}'; this.classList.add('fallback-image');">
                        {% else %}
                        <div class="profile-image bg-secondary d-flex align-items-center justify-content-center">
                            <i class="fas fa-user fa-3x"></i>
                        </div>
                        {% endif %}
                        <h3 class="profile-name">{{ datos_personales.nombres }} {{ datos_personales.apellidos }}</h3>
                        <p class="profile-title">{{ datos_personales.ocupacion }}</p>
                    {% else %}
                        <div class="profile-image bg-secondary d-flex align-items-center justify-content-center">
                            <i class="fas fa-user fa-3x"></i>
                        </div>
                        <h3 class="profile-name">Nombre Apellido</h3>
                        <p class="profile-title">Profesión</p>
                    {% endif %}
                </div>
                
                <!-- Ícono de filtro (visible solo cuando el sidebar está colapsado) -->
                <div class="filtro-icon">
                    <i class="fas fa-filter"></i>
                </div>
                
                <!-- Filtros para Venta de Garaje (visibles solo cuando el sidebar está expandido) -->
                <div class="nav-container filtros-container-sidebar">
                    <h4 class="filtros-title">Filtrar Productos</h4>
                    
                    <form id="filtros-sidebar-form">
                        <!-- Barra de búsqueda -->
                        <div class="mb-3">
                            <label for="sidebar-busqueda" class="form-label">Buscar</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="sidebar-busqueda" placeholder="Buscar productos...">
                                <button class="btn btn-outline-light" type="button" id="btn-buscar">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Rango de precios -->
                        <div class="mb-3">
                            <label class="form-label">Rango de precios</label>
                            <div class="d-flex gap-2">
                                <div class="flex-grow-1">
                                    <input type="number" class="form-control" id="sidebar-precio-min" min="0" step="0.01" placeholder="Mín">
                                </div>
                                <div class="flex-grow-1">
                                    <input type="number" class="form-control" id="sidebar-precio-max" min="0" step="0.01" placeholder="Máx">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Estado -->
                        <div class="mb-3">
                            <label for="sidebar-estado" class="form-label">Estado</label>
                            <select class="form-select" id="sidebar-estado">
                                <option value="">Todos</option>
                                <option value="bueno">Bueno</option>
                                <option value="regular">Regular</option>
                            </select>
                        </div>
                        
                        <!-- Botones de acción -->
                        <button type="submit" class="btn btn-primary w-100 mb-2">
                            <i class="fas fa-filter me-2"></i> Filtrar
                        </button>
                        <button type="reset" class="btn btn-secondary w-100">
                            <i class="fas fa-undo me-2"></i> Limpiar
                        </button>
                    </form>
                </div>
                
                <!-- Botón de tema -->
                <div class="control-buttons">
                    <button id="theme-toggle" class="control-button" data-tooltip="Modo Oscuro">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="content">
                {% block content %}{% endblock %}
            </div>
        </div>
    </div>
    
    <!-- Header deslizable -->
    <div id="header-trigger">
        <div class="arrow-down">
            <i class="fas fa-chevron-down"></i>
        </div>
    </div>
    
    <div id="slide-down-header">
        <div class="header-nav-buttons">
            <button class="header-nav-button" data-target="cv">Hoja de Vida</button>
            <button class="header-nav-button active" data-target="garage-sale">Venta de Garaje</button>
        </div>
    </div>
    
    <!-- Bootstrap JS y Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    
    <!-- JavaScript personalizado -->
    <script src="{% static 'js/main.js' %}"></script>
    <script src="{% static 'js/cloudinary-handler.js' %}"></script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Inicializar el tema guardado
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            const themeToggle = document.getElementById('theme-toggle');
            if (themeToggle) {
                themeToggle.classList.add('active');
                // Cambiar el ícono a sol en modo oscuro
                const moonIcon = themeToggle.querySelector('i');
                if (moonIcon) {
                    moonIcon.classList.remove('fa-moon');
                    moonIcon.classList.add('fa-sun');
                }
            }
        }
        
        // Manejar el cambio de tema
        const themeToggle = document.getElementById('theme-toggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', function() {
                const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                const moonIcon = this.querySelector('i');
                
                if (isDark) {
                    document.documentElement.removeAttribute('data-theme');
                    localStorage.setItem('theme', 'light');
                    this.classList.remove('active');
                    // Cambiar el ícono a luna
                    if (moonIcon) {
                        moonIcon.classList.remove('fa-sun');
                        moonIcon.classList.add('fa-moon');
                    }
                } else {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    localStorage.setItem('theme', 'dark');
                    this.classList.add('active');
                    // Cambiar el ícono a sol
                    if (moonIcon) {
                        moonIcon.classList.remove('fa-moon');
                        moonIcon.classList.add('fa-sun');
                    }
                }
            });
        }
        
        // Configurar el header deslizable
        const headerTrigger = document.getElementById('header-trigger');
        const slideDownHeader = document.getElementById('slide-down-header');
        
        if (headerTrigger && slideDownHeader) {
            // Mostrar el header al pasar el ratón sobre el trigger
            headerTrigger.addEventListener('mouseenter', function() {
                slideDownHeader.classList.add('active');
            });
            
            // Mantener el header visible cuando el mouse está sobre él
            slideDownHeader.addEventListener('mouseenter', function() {
                this.classList.add('active');
            });
            
            // Ocultar el header al alejar el ratón
            slideDownHeader.addEventListener('mouseleave', function() {
                this.classList.remove('active');
            });
            
            // Manejar los botones de navegación
            const navButtons = document.querySelectorAll('.header-nav-button');
            navButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remover clase activa de todos los botones
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Agregar clase activa al botón clickeado
                    this.classList.add('active');
                    
                    // Redirigir según el botón seleccionado
                    const target = this.getAttribute('data-target');
                    if (target === 'garage-sale') {
                        // Redirigir a la página de venta de garaje
                        window.location.href = '/venta-garaje/';
                    } else {
                        // Redirigir a la hoja de vida
                        window.location.href = '/';
                    }
                });
            });
        }
        
        // Configurar la sidebar colapsable
        const sidebar = document.querySelector('.sidebar');
        const content = document.querySelector('.content');
        
        if (sidebar && content) {
            // Colapsar la sidebar al cargar la página en pantallas grandes
            if (window.innerWidth > 991) {
                sidebar.classList.add('collapsed');
                content.classList.add('expanded');
            }
            
            // Colapsar la sidebar cuando el mouse sale de ella
            sidebar.addEventListener('mouseleave', function() {
                if (window.innerWidth > 991) { // Solo en pantallas grandes
                    sidebar.classList.add('collapsed');
                    content.classList.add('expanded');
                }
            });
            
            // Expandir la sidebar cuando el mouse entra en ella
            sidebar.addEventListener('mouseenter', function() {
                sidebar.classList.remove('collapsed');
                content.classList.remove('expanded');
            });
        }
    });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>